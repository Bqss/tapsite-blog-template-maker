<!-- Search Header -->
<section class="bg-gradient-to-br from-green-50 via-blue-50 to-purple-50 py-16">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center">
      <div class="inline-flex items-center bg-white/80 backdrop-blur-sm rounded-full px-6 py-3 mb-6 shadow-lg">
        <span class="text-2xl mr-3">üîç</span>
        <span class="text-green-600 font-semibold">Search Sports Analysis</span>
      </div>
      <h1 class="text-4xl lg:text-5xl font-bold text-gray-900 mb-6 leading-tight">
        Find Sports <span
          class="text-transparent bg-clip-text bg-gradient-to-r from-green-600 to-blue-600">Analysis</span>
      </h1>
      <p class="text-xl text-gray-600 mb-8 leading-relaxed">
        Search through our comprehensive database of sports analysis, match reports, and expert commentary.
      </p>

      <!-- Search Form -->
      <div class="max-w-2xl mx-auto">
        <form id="search-form" class="relative" action="/search" method="GET">
          <div class="flex items-center bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg overflow-hidden">
            <input id="search-input" name="q" type="text"
              placeholder="Search for teams, players, matches, or analysis..."
              class="flex-1 px-6 py-4 text-gray-700 bg-transparent focus:outline-none">
            <button type="submit"
              class="bg-green-600 hover:bg-green-700 text-white px-8 py-4 font-semibold transition-colors">
              Search
            </button>
          </div>
        </form>

        <!-- Popular Searches -->
        <div class="mt-6 flex flex-wrap gap-2 justify-center">
          <span class="text-sm text-gray-600">Popular searches:</span>
          <a href="/search/Champions League"
            class="text-sm bg-white/70 text-green-600 px-3 py-1 rounded-full hover:bg-white transition-colors">
            Champions League
          </a>
          <a href="/search/Premier League"
            class="text-sm bg-white/70 text-green-600 px-3 py-1 rounded-full hover:bg-white transition-colors">
            Premier League
          </a>
          <a href="/search/Manchester City"
            class="text-sm bg-white/70 text-green-600 px-3 py-1 rounded-full hover:bg-white transition-colors">
            Manchester City
          </a>
          <a href="/search/tactical analysis"
            class="text-sm bg-white/70 text-green-600 px-3 py-1 rounded-full hover:bg-white transition-colors">
            tactical analysis
          </a>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Live Scores Banner -->
<section class="py-4 bg-gray-900 text-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center space-x-8 overflow-x-auto">
      <div class="flex items-center space-x-2 min-w-max">
        <span class="bg-red-500 px-2 py-1 rounded text-xs font-bold">LIVE</span>
        <span class="font-semibold">Arsenal vs Man United</span>
        <span class="text-green-400 font-bold">2-1</span>
        <span class="text-gray-400">67'</span>
      </div>
      <div class="flex items-center space-x-2 min-w-max">
        <span class="bg-green-500 px-2 py-1 rounded text-xs font-bold">FT</span>
        <span class="font-semibold">Barcelona vs Real Madrid</span>
        <span class="text-green-400 font-bold">3-2</span>
        <span class="text-gray-400">El Clasico</span>
      </div>
      <div class="flex items-center space-x-2 min-w-max">
        <span class="bg-blue-500 px-2 py-1 rounded text-xs font-bold">HT</span>
        <span class="font-semibold">PSG vs Monaco</span>
        <span class="text-green-400 font-bold">1-0</span>
        <span class="text-gray-400">45'</span>
      </div>
    </div>
  </div>
</section>

<!-- Search Results -->
<section class="py-16 bg-gray-50">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="mb-8">
      <h2 id="search-title" class="text-2xl font-bold text-gray-900 mb-2"></h2>
      <p id="search-count" class="text-gray-600"></p>
    </div>

    <div id="search-loading" class="flex justify-center py-12">
      <div class="inline-block animate-spin rounded-full h-10 w-10 border-b-2 border-green-600"></div>
    </div>
    <div id="search-error" class="text-center py-12 hidden">
      <p class="text-red-500">Failed to load results.</p>
    </div>
    <div id="search-empty" class="text-center py-12 hidden">
      <p class="text-gray-500">No results found.</p>
    </div>
    <div id="search-results" class="space-y-6 hidden">
      <!-- Search Result 1 -->
      <article
        class="bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1 cursor-pointer group">
        <div class="flex items-start space-x-4">
          <img src="https://images.unsplash.com/photo-1461896836934-ffe607ba8211?w=120&h=120&fit=crop"
            alt="Champions League Final"
            class="w-24 h-24 rounded-xl object-cover group-hover:scale-105 transition-transform duration-300">
          <div class="flex-1">
            <div class="flex items-center space-x-2 mb-2">
              <span class="bg-green-100 text-green-800 px-2 py-1 rounded-lg text-xs font-semibold">Football</span>
              <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-lg text-xs font-semibold">Champions League</span>
              <span class="text-gray-500 text-sm">12 min read</span>
              <span class="text-gray-500 text-sm">üëÅÔ∏è 8.5K views</span>
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-2 group-hover:text-green-600 transition-colors">
              Champions League Final Analysis: Manchester City vs Inter Milan
            </h3>
            <p class="text-gray-600 mb-3">
              Comprehensive tactical analysis of the Champions League final including key moments, player performances,
              and strategic decisions that decided the match...
            </p>
            <div class="flex items-center justify-between">
              <div class="flex items-center space-x-2">
                <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=24&h=24&fit=crop&crop=face"
                  alt="James Tactical" class="w-6 h-6 rounded-full">
                <span class="text-sm text-gray-700">James Tactical</span>
              </div>
              <span class="text-sm text-gray-500">June 10, 2024</span>
            </div>
          </div>
        </div>
      </article>

      <!-- Search Result 2 -->
      <article
        class="bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1 cursor-pointer group">
        <div class="flex items-start space-x-4">
          <img src="https://images.unsplash.com/photo-1552318965-6e6be7484ada?w=120&h=120&fit=crop"
            alt="Champions League History"
            class="w-24 h-24 rounded-xl object-cover group-hover:scale-105 transition-transform duration-300">
          <div class="flex-1">
            <div class="flex items-center space-x-2 mb-2">
              <span class="bg-green-100 text-green-800 px-2 py-1 rounded-lg text-xs font-semibold">Football</span>
              <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded-lg text-xs font-semibold">History</span>
              <span class="text-gray-500 text-sm">18 min read</span>
              <span class="text-gray-500 text-sm">üëÅÔ∏è 15.2K views</span>
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-2 group-hover:text-green-600 transition-colors">
              Greatest Champions League Finals in History: A Comprehensive Review
            </h3>
            <p class="text-gray-600 mb-3">
              Looking back at the most memorable Champions League finals and the moments that defined European football
              history...
            </p>
            <div class="flex items-center justify-between">
              <div class="flex items-center space-x-2">
                <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=24&h=24&fit=crop&crop=face"
                  alt="History Expert" class="w-6 h-6 rounded-full">
                <span class="text-sm text-gray-700">History Expert</span>
              </div>
              <span class="text-sm text-gray-500">May 28, 2024</span>
            </div>
          </div>
        </div>
      </article>

      <!-- Search Result 3 -->
      <article
        class="bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1 cursor-pointer group">
        <div class="flex items-start space-x-4">
          <img src="https://images.unsplash.com/photo-1546519638-68e109498ffc?w=120&h=120&fit=crop"
            alt="Champions League Predictions"
            class="w-24 h-24 rounded-xl object-cover group-hover:scale-105 transition-transform duration-300">
          <div class="flex-1">
            <div class="flex items-center space-x-2 mb-2">
              <span class="bg-green-100 text-green-800 px-2 py-1 rounded-lg text-xs font-semibold">Football</span>
              <span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded-lg text-xs font-semibold">Predictions</span>
              <span class="text-gray-500 text-sm">10 min read</span>
              <span class="text-gray-500 text-sm">üëÅÔ∏è 6.8K views</span>
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-2 group-hover:text-green-600 transition-colors">
              Champions League Final Predictions: Expert Analysis and Betting Odds
            </h3>
            <p class="text-gray-600 mb-3">
              Our expert panel provides in-depth predictions for the upcoming Champions League final with statistical
              analysis and key factors...
            </p>
            <div class="flex items-center justify-between">
              <div class="flex items-center space-x-2">
                <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=24&h=24&fit=crop&crop=face"
                  alt="Prediction Expert" class="w-6 h-6 rounded-full">
                <span class="text-sm text-gray-700">Prediction Expert</span>
              </div>
              <span class="text-sm text-gray-500">June 8, 2024</span>
            </div>
          </div>
        </div>
      </article>

      <!-- Search Result 4 -->
      <article
        class="bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1 cursor-pointer group">
        <div class="flex items-start space-x-4">
          <img src="https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=120&h=120&fit=crop"
            alt="Champions League Stats"
            class="w-24 h-24 rounded-xl object-cover group-hover:scale-105 transition-transform duration-300">
          <div class="flex-1">
            <div class="flex items-center space-x-2 mb-2">
              <span class="bg-green-100 text-green-800 px-2 py-1 rounded-lg text-xs font-semibold">Football</span>
              <span class="bg-red-100 text-red-800 px-2 py-1 rounded-lg text-xs font-semibold">Statistics</span>
              <span class="text-gray-500 text-sm">8 min read</span>
              <span class="text-gray-500 text-sm">üëÅÔ∏è 4.3K views</span>
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-2 group-hover:text-green-600 transition-colors">
              Champions League Final Statistics: Numbers That Tell the Story
            </h3>
            <p class="text-gray-600 mb-3">
              Breaking down the key statistics from Champions League finals over the past decade and what they reveal
              about modern football...
            </p>
            <div class="flex items-center justify-between">
              <div class="flex items-center space-x-2">
                <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=24&h=24&fit=crop&crop=face"
                  alt="Stats Analyst" class="w-6 h-6 rounded-full">
                <span class="text-sm text-gray-700">Stats Analyst</span>
              </div>
              <span class="text-sm text-gray-500">June 5, 2024</span>
            </div>
          </div>
        </div>
      </article>

      <!-- Search Result 5 -->
      <article
        class="bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1 cursor-pointer group">
        <div class="flex items-start space-x-4">
          <img src="https://images.unsplash.com/photo-1594736797933-d0d8ba2c2e13?w=120&h=120&fit=crop"
            alt="Champions League Teams"
            class="w-24 h-24 rounded-xl object-cover group-hover:scale-105 transition-transform duration-300">
          <div class="flex-1">
            <div class="flex items-center space-x-2 mb-2">
              <span class="bg-green-100 text-green-800 px-2 py-1 rounded-lg text-xs font-semibold">Football</span>
              <span class="bg-orange-100 text-orange-800 px-2 py-1 rounded-lg text-xs font-semibold">Team
                Analysis</span>
              <span class="text-gray-500 text-sm">14 min read</span>
              <span class="text-gray-500 text-sm">üëÅÔ∏è 7.9K views</span>
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-2 group-hover:text-green-600 transition-colors">
              Road to Champions League Final: How Teams Reached the Ultimate Stage
            </h3>
            <p class="text-gray-600 mb-3">
              Analyzing the journey of finalists through the Champions League knockout stages and the key performances
              that got them there...
            </p>
            <div class="flex items-center justify-between">
              <div class="flex items-center space-x-2">
                <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=24&h=24&fit=crop&crop=face"
                  alt="Team Analyst" class="w-6 h-6 rounded-full">
                <span class="text-sm text-gray-700">Team Analyst</span>
              </div>
              <span class="text-sm text-gray-500">June 1, 2024</span>
            </div>
          </div>
        </div>
      </article>
    </div>

    <!-- Pagination -->
    <div class="mt-12 flex justify-center">
      <nav class="flex items-center space-x-2">
        <button class="px-4 py-2 text-gray-500 bg-white rounded-lg border hover:bg-gray-50 transition-colors">
          Previous
        </button>
        <button class="px-4 py-2 bg-green-600 text-white rounded-lg font-semibold">
          1
        </button>
        <button class="px-4 py-2 text-gray-700 bg-white rounded-lg border hover:bg-gray-50 transition-colors">
          2
        </button>
        <button class="px-4 py-2 text-gray-700 bg-white rounded-lg border hover:bg-gray-50 transition-colors">
          3
        </button>
        <button class="px-4 py-2 text-gray-700 bg-white rounded-lg border hover:bg-gray-50 transition-colors">
          Next
        </button>
      </nav>
    </div>
  </div>
</section>

<!-- Search Tips -->
<section class="py-16 bg-white">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-12">
      <h2 class="text-3xl font-bold text-gray-900 mb-4">Search Tips</h2>
      <p class="text-xl text-gray-600">Get better results with these search tips</p>
    </div>

    <div class="grid md:grid-cols-2 gap-8">
      <div class="bg-green-50 rounded-2xl p-6">
        <div class="flex items-start space-x-4">
          <div class="w-12 h-12 bg-green-600 rounded-full flex items-center justify-center text-white text-xl">
            ‚öΩ
          </div>
          <div>
            <h3 class="text-lg font-bold text-gray-900 mb-2">Search by Team or Player</h3>
            <p class="text-gray-600">
              Try specific team names like "Manchester City" or player names like "Erling Haaland" for targeted results.
            </p>
          </div>
        </div>
      </div>

      <div class="bg-blue-50 rounded-2xl p-6">
        <div class="flex items-start space-x-4">
          <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center text-white text-xl">
            üèÜ
          </div>
          <div>
            <h3 class="text-lg font-bold text-gray-900 mb-2">Filter by Competition</h3>
            <p class="text-gray-600">
              Use competition names like "Champions League", "Premier League", or "World Cup" to find specific
              tournament coverage.
            </p>
          </div>
        </div>
      </div>

      <div class="bg-purple-50 rounded-2xl p-6">
        <div class="flex items-start space-x-4">
          <div class="w-12 h-12 bg-purple-600 rounded-full flex items-center justify-center text-white text-xl">
            üìä
          </div>
          <div>
            <h3 class="text-lg font-bold text-gray-900 mb-2">Search by Analysis Type</h3>
            <p class="text-gray-600">
              Try keywords like "tactical analysis", "match report", or "statistics" to find specific types of content.
            </p>
          </div>
        </div>
      </div>

      <div class="bg-orange-50 rounded-2xl p-6">
        <div class="flex items-start space-x-4">
          <div class="w-12 h-12 bg-orange-600 rounded-full flex items-center justify-center text-white text-xl">
            üîç
          </div>
          <div>
            <h3 class="text-lg font-bold text-gray-900 mb-2">Browse by Sport</h3>
            <p class="text-gray-600">
              Use our sport categories to browse specific sports like Football, Basketball, Tennis, or Formula 1.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  (function () {
    const LIMIT = 50;
    const params = new URLSearchParams(window.location.search);
    let query = params.get('q') || decodeURIComponent(window.location.pathname.split('/').pop());
    if (!query || query === 'search') { query = ''; }

    const input = document.getElementById('search-input'); if (input) input.value = query;

    const titleEl = document.getElementById('search-title');
    const countEl = document.getElementById('search-count');
    const loadEl = document.getElementById('search-loading');
    const errEl = document.getElementById('search-error');
    const emptyEl = document.getElementById('search-empty');
    const resultsEl = document.getElementById('search-results');

    const fallbackImg = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='200' viewBox='0 0 400 200'%3E%3Crect width='400' height='200' fill='%23f3f4f6'/%3E%3Ctext x='200' y='100' text-anchor='middle' dy='0.3em' font-family='Arial' font-size='16' fill='%23666'%3ENo Image%3C/text%3E%3C/svg%3E";

    function card(p) {
      const img = p.featured_image || fallbackImg;
      return `<article class='bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1 cursor-pointer group'>\n      <div class='flex items-start space-x-4'>\n        <img src='${img}' alt='${p.title}' class='w-24 h-24 rounded-xl object-cover group-hover:scale-105 transition-transform duration-300'>\n        <div class='flex-1'>\n          <div class='flex items-center space-x-2 mb-2'>\n            ${p.category ? `<span class='bg-green-100 text-green-800 px-2 py-1 rounded-lg text-xs font-semibold'>${p.category}</span>` : ''}\n            ${p.subcategory ? `<span class='bg-blue-100 text-blue-800 px-2 py-1 rounded-lg text-xs font-semibold'>${p.subcategory}</span>` : ''}\n            <span class='text-gray-500 text-sm'>${p.read_time || 5} min read</span>\n            <span class='text-gray-500 text-sm'>üëÅÔ∏è ${p.view_count || 0} views</span>\n          </div>\n          <h3 class='text-xl font-bold text-gray-900 mb-2 group-hover:text-green-600 transition-colors line-clamp-2'>${p.title}</h3>\n          <p class='text-gray-600 mb-3 line-clamp-3'>${p.excerpt || ''}</p>\n          <div class='flex items-center justify-between'>\n            <div class='flex items-center space-x-2'>\n              <img src='${p.author_avatar || "/images/default-avatar.png"}' class='w-6 h-6 rounded-full' alt='${p.author}'>\n              <span class='text-sm text-gray-700'>${p.author || ''}</span>\n            </div>\n            <span class='text-sm text-gray-500'>${new Date(p.published_at).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</span>\n          </div>\n        </div>\n      </div>\n    </article>`;
    }

    async function search() {
      if (!query) { emptyEl.classList.remove('hidden'); loadEl.classList.add('hidden'); return; }
      titleEl.textContent = `Search Results for "${query}"`;
      loadEl.classList.remove('hidden'); errEl.classList.add('hidden'); emptyEl.classList.add('hidden');
      try {
        const res = await fetch(`/api/blog/posts/search/${encodeURIComponent(query)}?limit=${LIMIT}`);
        if (!res.ok) throw new Error();
        const data = await res.json();
        const posts = data || [];
        countEl.textContent = `Found ${posts.length} article${posts.length !== 1 ? 's' : ''}`;
        if (!posts.length) { emptyEl.classList.remove('hidden'); return; }
        resultsEl.innerHTML = posts.map(card).join('');
        resultsEl.classList.remove('hidden');
      } catch (e) { console.error(e); errEl.classList.remove('hidden'); }
      finally { loadEl.classList.add('hidden'); }
    }

    const form = document.getElementById('search-form');
    if (form) { form.addEventListener('submit', e => { e.preventDefault(); const q = input.value.trim(); if (q) { window.location.href = `/search/${encodeURIComponent(q)}`; } }); }

    document.addEventListener('DOMContentLoaded', search);
  })();
</script>