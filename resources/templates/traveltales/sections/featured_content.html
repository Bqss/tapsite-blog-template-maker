<!-- Featured Travel Stories -->
<section class="py-16 bg-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-12">
      <h2 class="font-display text-3xl lg:text-4xl font-bold text-travel-dark mb-4">Featured Travel Stories</h2>
      <p class="text-xl text-gray-600 max-w-2xl mx-auto">
        Inspiring adventures and comprehensive guides from our expert travel writers
      </p>
    </div>

    <div id="feat-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      <!-- Story 1 -->
      <article
        class="travel-card bg-white rounded-2xl shadow-lg overflow-hidden transition-all duration-300 border border-gray-100">
        <div class="relative">
          <img src="https://images.unsplash.com/photo-1552465011-b4e21bf6e79a?w=400&h=250&fit=crop"
            alt="Southeast Asia Backpacking" class="w-full h-48 object-cover">
          <div class="absolute top-4 left-4">
            <span class="bg-travel-orange text-white px-3 py-1 rounded-full text-sm font-medium">Backpacking</span>
          </div>
          <div class="absolute top-4 right-4">
            <span class="bg-white text-travel-dark px-3 py-1 rounded-full text-sm font-medium">$30-50/day</span>
          </div>
          <div class="absolute bottom-4 left-4 right-4">
            <div class="flex items-center space-x-2 text-white text-sm">
              <span class="bg-black bg-opacity-50 px-2 py-1 rounded-full">üìç Southeast Asia</span>
              <span class="bg-black bg-opacity-50 px-2 py-1 rounded-full">‚è±Ô∏è 3-4 weeks</span>
            </div>
          </div>
        </div>
        <div class="p-6">
          <div class="flex items-center space-x-2 mb-3">
            <img src="https://images.unsplash.com/photo-1494790108755-2616b612b786?w=40&h=40&fit=crop&crop=face"
              alt="Sarah Adventure" class="w-8 h-8 rounded-full">
            <span class="text-gray-600 text-sm">Sarah Adventure</span>
            <span class="text-gray-400 text-sm">‚Ä¢</span>
            <span class="text-gray-500 text-sm">15 min read</span>
          </div>
          <h3 class="font-display text-xl font-semibold text-travel-dark mb-3 line-clamp-2">
            Ultimate Guide to Backpacking Through Southeast Asia
          </h3>
          <p class="text-gray-600 text-sm mb-4 line-clamp-3">
            Complete travel guide for backpacking through Thailand, Vietnam, Cambodia, and Laos on a budget with insider
            tips.
          </p>

          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-2">
              <span class="text-xs text-gray-500">Dec 15, 2024</span>
            </div>
            <button class="text-travel-blue font-medium hover:text-travel-navy transition-colors">
              Read Guide ‚Üí
            </button>
          </div>
        </div>
      </article>

      <!-- Story 2 -->
      <article
        class="travel-card bg-white rounded-2xl shadow-lg overflow-hidden transition-all duration-300 border border-gray-100">
        <div class="relative">
          <img src="https://images.unsplash.com/photo-1516426122078-c23e76319801?w=400&h=250&fit=crop"
            alt="Kenya Safari" class="w-full h-48 object-cover">
          <div class="absolute top-4 left-4">
            <span class="bg-green-500 text-white px-3 py-1 rounded-full text-sm font-medium">Safari</span>
          </div>
          <div class="absolute top-4 right-4">
            <span class="bg-white text-travel-dark px-3 py-1 rounded-full text-sm font-medium">$500-1000/day</span>
          </div>
          <div class="absolute bottom-4 left-4 right-4">
            <div class="flex items-center space-x-2 text-white text-sm">
              <span class="bg-black bg-opacity-50 px-2 py-1 rounded-full">üìç Kenya</span>
              <span class="bg-black bg-opacity-50 px-2 py-1 rounded-full">‚è±Ô∏è 7-10 days</span>
            </div>
          </div>
        </div>
        <div class="p-6">
          <div class="flex items-center space-x-2 mb-3">
            <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face"
              alt="Michael Explorer" class="w-8 h-8 rounded-full">
            <span class="text-gray-600 text-sm">Michael Explorer</span>
            <span class="text-gray-400 text-sm">‚Ä¢</span>
            <span class="text-gray-500 text-sm">12 min read</span>
          </div>
          <h3 class="font-display text-xl font-semibold text-travel-dark mb-3 line-clamp-2">
            Luxury Safari Experience in Kenya: Masai Mara Wildlife
          </h3>
          <p class="text-gray-600 text-sm mb-4 line-clamp-3">
            Experience the ultimate luxury safari in Kenya's Masai Mara with exclusive lodges and wildlife encounters.
          </p>

          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-2">
              <span class="text-xs text-gray-500">Dec 14, 2024</span>
            </div>
            <button class="text-travel-blue font-medium hover:text-travel-navy transition-colors">
              Read Guide ‚Üí
            </button>
          </div>
        </div>
      </article>

      <!-- Story 3 -->
      <article
        class="travel-card bg-white rounded-2xl shadow-lg overflow-hidden transition-all duration-300 border border-gray-100">
        <div class="relative">
          <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&h=250&fit=crop"
            alt="Iceland Adventure" class="w-full h-48 object-cover">
          <div class="absolute top-4 left-4">
            <span class="bg-purple-500 text-white px-3 py-1 rounded-full text-sm font-medium">Adventure</span>
          </div>
          <div class="absolute top-4 right-4">
            <span class="bg-white text-travel-dark px-3 py-1 rounded-full text-sm font-medium">$150-250/day</span>
          </div>
          <div class="absolute bottom-4 left-4 right-4">
            <div class="flex items-center space-x-2 text-white text-sm">
              <span class="bg-black bg-opacity-50 px-2 py-1 rounded-full">üìç Iceland</span>
              <span class="bg-black bg-opacity-50 px-2 py-1 rounded-full">‚è±Ô∏è 10-14 days</span>
            </div>
          </div>
        </div>
        <div class="p-6">
          <div class="flex items-center space-x-2 mb-3">
            <img src="https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop&crop=face"
              alt="Emma Wanderer" class="w-8 h-8 rounded-full">
            <span class="text-gray-600 text-sm">Emma Wanderer</span>
            <span class="text-gray-400 text-sm">‚Ä¢</span>
            <span class="text-gray-500 text-sm">10 min read</span>
          </div>
          <h3 class="font-display text-xl font-semibold text-travel-dark mb-3 line-clamp-2">
            Hidden Gems of Iceland: Off-the-Beaten-Path Adventures
          </h3>
          <p class="text-gray-600 text-sm mb-4 line-clamp-3">
            Discover Iceland's secret locations away from tourist crowds, including hidden waterfalls and remote hot
            springs.
          </p>

          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-2">
              <span class="text-xs text-gray-500">Dec 13, 2024</span>
            </div>
            <button class="text-travel-blue font-medium hover:text-travel-navy transition-colors">
              Read Guide ‚Üí
            </button>
          </div>
        </div>
      </article>
    </div>

    <div class="text-center mt-12">
      <button
        class="bg-travel-blue text-white px-8 py-3 rounded-lg font-semibold hover:bg-travel-navy transition-colors">
        View All Travel Stories
      </button>
    </div>
  </div>
</section>

<script>
(function(){
  const LIMIT = 6;
  const gridEl = document.getElementById('feat-grid');
  if(!gridEl) return;

  // create loading, error states
  const loadEl = document.createElement('div');
  loadEl.id = 'feat-loading';
  loadEl.className = 'flex justify-center py-12';
  loadEl.innerHTML = '<div class="inline-block animate-spin rounded-full h-10 w-10 border-b-2 border-travel-blue"></div>';
  gridEl.parentNode.insertBefore(loadEl, gridEl);

  const errEl = document.createElement('div');
  errEl.id = 'feat-error';
  errEl.className = 'text-center py-12 hidden';
  errEl.innerHTML = '<p class="text-red-500">Failed to load stories.</p>';
  gridEl.parentNode.insertBefore(errEl, gridEl);

  const fallbackImg = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='200' viewBox='0 0 400 200'%3E%3Crect width='400' height='200' fill='%23f3f4f6'/%3E%3Ctext x='200' y='100' text-anchor='middle' dy='0.3em' font-family='Arial' font-size='16' fill='%23666'%3ENo Image%3C/text%3E%3C/svg%3E";

  function card(p){
    const img = p.featured_image || fallbackImg;
    return `<article class='travel-card bg-white rounded-2xl shadow-lg overflow-hidden transition-all duration-300 border border-gray-100'>\n      <div class='relative'>\n        <img src='${img}' alt='${p.title}' class='w-full h-48 object-cover'>\n        ${p.category ? `<div class='absolute top-4 left-4'><span class='bg-travel-orange text-white px-3 py-1 rounded-full text-sm font-medium'>${p.category}</span></div>` : ''}\n        ${p.budget ? `<div class='absolute top-4 right-4'><span class='bg-white text-travel-dark px-3 py-1 rounded-full text-sm font-medium'>${p.budget}</span></div>` : ''}\n      </div>\n      <div class='p-6'>\n        <div class='flex items-center space-x-2 mb-3'>\n          <img src='${p.author_avatar || "/images/default-avatar.png"}' class='w-8 h-8 rounded-full' alt='${p.author}'>\n          <span class='text-gray-600 text-sm'>${p.author || ''}</span>\n          <span class='text-gray-400 text-sm'>‚Ä¢</span>\n          <span class='text-gray-500 text-sm'>${p.read_time || 5} min read</span>\n        </div>\n        <h3 class='font-display text-xl font-semibold text-travel-dark mb-3 line-clamp-2'>${p.title}</h3>\n        <p class='text-gray-600 text-sm mb-4 line-clamp-3'>${p.excerpt || ''}</p>\n        <div class='flex items-center justify-between'>\n          <div class='flex items-center space-x-2'>\n            <span class='text-xs text-gray-500'>${new Date(p.published_at).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'})}</span>\n          </div>\n          <a href='/post/${p.slug}' class='text-travel-blue font-medium hover:text-travel-navy transition-colors'>Read Guide ‚Üí</a>\n        </div>\n      </div>\n    </article>`;
  }

  async function load(){
    loadEl.classList.remove('hidden');
    try{
      const res = await fetch(`/api/blog/posts/recent?limit=${LIMIT}`);
      if(!res.ok) throw new Error();
      const data = await res.json();
      const posts = data || [];
      if(!posts.length){
        loadEl.innerHTML = '<p class="text-gray-500">No stories available.</p>';
        return;
      }
      gridEl.innerHTML = posts.map(card).join('');
    }catch(e){
      console.error(e);
      errEl.classList.remove('hidden');
    }finally{
      loadEl.classList.add('hidden');
    }
  }

  document.addEventListener('DOMContentLoaded', ()=>{
    gridEl.innerHTML = '';
    load();
  });
})();
</script>