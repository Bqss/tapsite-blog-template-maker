<!-- Medical Disclaimer -->
<section class="py-4 bg-yellow-50 border-b border-yellow-200">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="medical-disclaimer p-4 rounded-lg">
      <div class="flex items-start space-x-3">
        <div class="flex-shrink-0">
          <svg class="w-5 h-5 text-yellow-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z" />
          </svg>
        </div>
        <div>
          <p class="text-sm text-yellow-800">
            <strong>Medical Disclaimer:</strong> Content is for informational purposes only and should not replace
            professional medical advice.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Search Header -->
<section class="bg-gradient-to-r from-health-green to-health-emerald py-16 text-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center">
      <h1 class="font-display text-4xl lg:text-5xl font-bold mb-4">Search Health Articles</h1>
      <p class="text-xl text-green-100 max-w-2xl mx-auto mb-8">
        Find evidence-based health information from our expert medical content library
      </p>

      <!-- Main Search Bar -->
      <div class="max-w-2xl mx-auto">
        <div class="relative">
          <input type="text" placeholder="Search for health topics, symptoms, treatments..."
            class="w-full px-6 py-4 pl-12 pr-16 text-gray-900 rounded-2xl focus:outline-none focus:ring-4 focus:ring-white focus:ring-opacity-50 text-lg">
          <svg class="w-6 h-6 text-gray-400 absolute left-4 top-5" fill="none" stroke="currentColor"
            viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
          <button
            class="absolute right-2 top-2 bg-health-green text-white px-6 py-2 rounded-xl hover:bg-health-emerald transition-colors">
            Search
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Search Results -->
<section class="py-16 bg-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Search Stats -->
    <div class="mb-8" id="search-stats" class="hidden">
      <h2 class="text-2xl font-bold text-health-dark mb-2">Search Results</h2>
      <p class="text-gray-600">Found <span id="search-count" class="font-semibold">0</span> articles for "<span id="search-query"></span>"</p>
    </div>

    <!-- Filters -->
    <div class="flex flex-wrap gap-4 mb-8 pb-6 border-b border-gray-200">
      <div class="flex items-center space-x-2">
        <span class="text-sm font-medium text-gray-700">Filter by:</span>
      </div>
      <button class="bg-health-green text-white px-4 py-2 rounded-full text-sm font-medium">All Results</button>
      <button
        class="bg-gray-100 text-gray-700 px-4 py-2 rounded-full text-sm font-medium hover:bg-health-light transition-colors">Technology</button>
      <button
        class="bg-gray-100 text-gray-700 px-4 py-2 rounded-full text-sm font-medium hover:bg-health-light transition-colors">Business</button>
      <button
        class="bg-gray-100 text-gray-700 px-4 py-2 rounded-full text-sm font-medium hover:bg-health-light transition-colors">Design</button>
      <button
        class="bg-gray-100 text-gray-700 px-4 py-2 rounded-full text-sm font-medium hover:bg-health-light transition-colors">Parenting</button>
    </div>

    <!-- Loading -->
    <div id="search-loading" class="py-12 text-center">
      <div class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-health-green border-t-transparent"></div>
      <p class="text-gray-500 mt-4">Searching articles...</p>
    </div>

    <!-- Error -->
    <div id="search-error" class="py-12 text-center hidden"><p class="text-red-500">Failed to load results.</p></div>

    <!-- Dynamic Grid -->
    <div id="search-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 hidden"></div>

    <!-- No Results State (Hidden by default) -->
    <div id="no-results" class="hidden text-center py-16">
      <div class="max-w-md mx-auto">
        <svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
        <h3 class="text-xl font-semibold text-gray-900 mb-2">No results found</h3>
        <p class="text-gray-600 mb-6">Try adjusting your search terms or browse our categories below.</p>
        <div class="flex flex-wrap gap-2 justify-center">
          <a href="/category/Technology"
            class="bg-health-light text-health-dark px-4 py-2 rounded-full text-sm hover:bg-health-mint transition-colors">Technology</a>
          <a href="/category/Business"
            class="bg-health-light text-health-dark px-4 py-2 rounded-full text-sm hover:bg-health-mint transition-colors">Business</a>
          <a href="/category/Design"
            class="bg-health-light text-health-dark px-4 py-2 rounded-full text-sm hover:bg-health-mint transition-colors">Design</a>
          <a href="/category/Parenting"
            class="bg-health-light text-health-dark px-4 py-2 rounded-full text-sm hover:bg-health-mint transition-colors">Parenting</a>
        </div>
      </div>
    </div>

    <!-- Pagination -->
    <div id="search-pagination" class="mt-16 flex justify-center"></div>
  </div>
</section>

<!-- Search Suggestions -->
<section class="py-16 bg-health-light">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <h2 class="font-display text-3xl font-bold text-health-dark mb-8 text-center">Popular Search Topics</h2>
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
      <a href="/search/AI" class="bg-white p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow text-center">
        <span class="text-2xl mb-2 block">🤖</span>
        <span class="font-medium text-health-dark">AI</span>
      </a>
      <a href="/search/Teknologi"
        class="bg-white p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow text-center">
        <span class="text-2xl mb-2 block">💻</span>
        <span class="font-medium text-health-dark">Teknologi</span>
      </a>
      <a href="/search/Bisnis" class="bg-white p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow text-center">
        <span class="text-2xl mb-2 block">💼</span>
        <span class="font-medium text-health-dark">Bisnis</span>
      </a>
      <a href="/search/Parenting"
        class="bg-white p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow text-center">
        <span class="text-2xl mb-2 block">👨‍👩‍👧‍👦</span>
        <span class="font-medium text-health-dark">Parenting</span>
      </a>
      <a href="/search/Indonesia"
        class="bg-white p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow text-center">
        <span class="text-2xl mb-2 block">🇮🇩</span>
        <span class="font-medium text-health-dark">Indonesia</span>
      </a>
      <a href="/search/Keluarga"
        class="bg-white p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow text-center">
        <span class="text-2xl mb-2 block">❤️</span>
        <span class="font-medium text-health-dark">Keluarga</span>
      </a>
      <a href="/search/UMKM" class="bg-white p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow text-center">
        <span class="text-2xl mb-2 block">🏪</span>
        <span class="font-medium text-health-dark">UMKM</span>
      </a>
      <a href="/search/Digitalisasi"
        class="bg-white p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow text-center">
        <span class="text-2xl mb-2 block">📱</span>
        <span class="font-medium text-health-dark">Digitalisasi</span>
      </a>
    </div>
  </div>
</section>

<script>
(function(){
  const loading=document.getElementById('search-loading');
  const error=document.getElementById('search-error');
  const grid=document.getElementById('search-grid');
  const stats=document.getElementById('search-stats');
  const countEl=document.getElementById('search-count');
  const queryEl=document.getElementById('search-query');
  const noRes=document.getElementById('no-results');
  const pagEl=document.getElementById('search-pagination');

  function getQuery(){const parts=window.location.pathname.split('/');const idx=parts.indexOf('search');return idx!==-1&&parts[idx+1]?decodeURIComponent(parts[idx+1]):'';}

  function card(p){return `<article class="article-card bg-white rounded-2xl shadow-lg overflow-hidden transition-all duration-300 border border-gray-100"><div class="relative"><img src="${p.featured_image||''}" alt="${p.title}" class="w-full h-48 object-cover"><div class="absolute top-4 left-4"><span class="bg-health-green text-white px-3 py-1 rounded-full text-sm font-medium">${p.category||'Health'}</span></div></div><div class="p-6"><div class="flex items-center space-x-4 mb-3 text-sm text-gray-600"><span>${p.author||'HealthWise'}</span></div><h3 class="font-display text-xl font-bold text-health-dark mb-3 leading-tight line-clamp-2"><a href="/post/${p.slug}">${p.title}</a></h3><p class="text-gray-600 mb-4 leading-relaxed line-clamp-3">${p.excerpt||''}</p><div class="flex items-center justify-between"><span class="text-sm text-gray-500">${new Date(p.published_at||Date.now()).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'})}</span><a href="/post/${p.slug}" class="text-health-green hover:text-health-emerald font-medium text-sm">Read More →</a></div></div></article>`;}

  async function search(q){if(!q){noRes.classList.add('hidden');return;}loading.classList.remove('hidden');error.classList.add('hidden');grid.classList.add('hidden');noRes.classList.add('hidden');pagEl.innerHTML='';
    try{
      const res=await fetch(`/api/blog/posts/search/${encodeURIComponent(q)}?limit=50`);
      if(!res.ok)throw new Error('http');const data=await res.json();
      countEl.textContent=data.length;queryEl.textContent=q;stats.classList.remove('hidden');
      if(data.length===0){noRes.classList.remove('hidden');}else{grid.innerHTML=data.map(card).join('');grid.classList.remove('hidden');}
    }catch(e){error.classList.remove('hidden');}
    finally{loading.classList.add('hidden');}
  }

  document.addEventListener('DOMContentLoaded',()=>{const q=getQuery();document.querySelector('input[type="text"]').value=q;search(q);});
})();
</script>