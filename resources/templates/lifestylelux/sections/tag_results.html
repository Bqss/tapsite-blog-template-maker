<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&display=swap');

  .elegant-border {
    border: 1px solid rgba(212, 175, 55, 0.3);
  }

  .gold-gradient {
    background: linear-gradient(135deg, #D4AF37, #FFD700);
  }

  .luxury-hover:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
  }

  .tag-cloud-item {
    transition: all 0.3s ease;
  }

  .tag-cloud-item:hover {
    transform: scale(1.05);
  }

  .curated-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
  }

  .featured-overlay {
    background: linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.7));
  }
</style>
<!-- Breadcrumb -->
<div class="max-w-7xl mx-auto px-4 lg:px-8 py-4">
  <nav class="text-sm">
    <a href="#" class="text-gray-500 hover:text-luxury-gold transition-colors">Home</a>
    <span class="mx-2 text-gray-400">/</span>
    <a href="#" class="text-gray-500 hover:text-luxury-gold transition-colors">Tags</a>
    <span class="mx-2 text-gray-400">/</span>
    <span id="breadcrumb-current" class="text-luxury-gold font-medium">Luxury</span>
  </nav>
</div>

<!-- Tag Header -->
<section class="relative h-64 lg:h-80 overflow-hidden mb-12">
  <img src="https://images.unsplash.com/photo-1594736797933-d0401ba2fe65?w=1920&h=800&fit=crop" alt="Luxury Tag"
    class="w-full h-full object-cover">
  <div class="absolute inset-0 featured-overlay flex items-center justify-center">
    <div class="text-center text-white px-4">
      <div class="inline-flex items-center space-x-3 mb-4">
        <span class="text-luxury-gold text-2xl">#</span>
        <h1 id="tag-title" class="font-serif text-4xl lg:text-6xl font-light">Luxury</h1>
      </div>
      <p id="tag-desc" class="text-xl font-light opacity-90 mb-4">Curated content showcasing the finest in luxury lifestyle</p>
      <div class="w-24 h-px bg-luxury-gold mx-auto"></div>
      <p id="tag-count" class="text-sm font-light mt-4 opacity-80">0 articles featuring this tag</p>
    </div>
  </div>
</section>

<!-- Tag Description -->
<section class="max-w-4xl mx-auto px-4 lg:px-8 mb-12">
  <div class="bg-white rounded-lg elegant-border p-8 text-center">
    <h2 class="font-serif text-2xl font-medium text-luxury-dark mb-4">About the Luxury Tag</h2>
    <p class="text-gray-600 leading-relaxed mb-6">
      Our luxury collection features carefully curated content that embodies the essence of refined living. From haute
      couture fashion and exquisite jewelry to premium travel experiences and fine dining, each article represents the
      pinnacle of craftsmanship, elegance, and sophisticated taste.
    </p>
    <div class="flex justify-center space-x-4">
      <div class="text-center">
        <div class="text-2xl font-serif font-medium text-luxury-gold">47</div>
        <div class="text-sm text-gray-500">Articles</div>
      </div>
      <div class="w-px bg-gray-300"></div>
      <div class="text-center">
        <div class="text-2xl font-serif font-medium text-luxury-gold">6</div>
        <div class="text-sm text-gray-500">Categories</div>
      </div>
      <div class="w-px bg-gray-300"></div>
      <div class="text-center">
        <div class="text-2xl font-serif font-medium text-luxury-gold">12K</div>
        <div class="text-sm text-gray-500">Total Reads</div>
      </div>
    </div>
  </div>
</section>

<!-- Related Tags -->
<section class="max-w-7xl mx-auto px-4 lg:px-8 mb-12">
  <div class="text-center mb-8">
    <h2 class="font-serif text-2xl font-medium text-luxury-dark mb-4">Related Tags</h2>
    <div class="w-16 h-px bg-luxury-gold mx-auto"></div>
  </div>

  <div id="related-tags" class="flex flex-wrap justify-center gap-3">
  </div>
</section>

<!-- Featured Article -->
<section class="max-w-7xl mx-auto px-4 lg:px-8 mb-16">
  <div class="text-center mb-8">
    <h2 class="font-serif text-3xl font-light text-luxury-dark mb-4">Featured Luxury Content</h2>
    <div class="w-16 h-px bg-luxury-gold mx-auto"></div>
  </div>

  <div id="featured-container" class="min-h-[200px] flex items-center justify-center py-12 text-gray-500">Loading...</div>
</section>

<!-- Articles Grid -->
<section class="max-w-7xl mx-auto px-4 lg:px-8 mb-16">
  <div class="flex justify-between items-center mb-8">
    <h2 class="font-serif text-2xl font-medium text-luxury-dark">All Luxury Articles</h2>
    <div class="flex items-center space-x-4">
      <span class="text-sm text-gray-600">Sort by:</span>
      <select class="elegant-border rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-luxury-gold">
        <option>Latest</option>
        <option>Most Popular</option>
        <option>Most Read</option>
        <option>Trending</option>
      </select>
    </div>
  </div>

  <div id="tag-grid" class="curated-grid">
    <!-- dynamic cards will be injected here -->
  </div>

  <!-- Load More -->
  <div class="text-center mt-12">
    <button
      class="bg-luxury-gold text-white px-8 py-3 rounded-full font-medium hover:bg-opacity-90 transition-all duration-300 hover:shadow-lg">
      Load More Luxury Content
    </button>
  </div>
</section>

<!-- Tag Statistics -->
<section class="bg-white py-16 border-t elegant-border">
  <div class="max-w-7xl mx-auto px-4 lg:px-8">
    <div class="text-center mb-12">
      <h2 class="font-serif text-3xl font-light text-luxury-dark mb-4">Luxury by the Numbers</h2>
      <div class="w-16 h-px bg-luxury-gold mx-auto"></div>
    </div>

    <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
      <div class="text-center">
        <div class="bg-luxury-light rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-luxury-gold" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
        </div>
        <div class="text-3xl font-serif font-medium text-luxury-gold mb-2">47</div>
        <div class="text-sm text-gray-600">Total Articles</div>
      </div>

      <div class="text-center">
        <div class="bg-luxury-light rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-luxury-gold" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
          </svg>
        </div>
        <div class="text-3xl font-serif font-medium text-luxury-gold mb-2">12.4K</div>
        <div class="text-sm text-gray-600">Total Views</div>
      </div>

      <div class="text-center">
        <div class="bg-luxury-light rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-luxury-gold" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
          </svg>
        </div>
        <div class="text-3xl font-serif font-medium text-luxury-gold mb-2">892</div>
        <div class="text-sm text-gray-600">Total Likes</div>
      </div>

      <div class="text-center">
        <div class="bg-luxury-light rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-luxury-gold" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
          </svg>
        </div>
        <div class="text-3xl font-serif font-medium text-luxury-gold mb-2">156</div>
        <div class="text-sm text-gray-600">Comments</div>
      </div>
    </div>
  </div>
</section>

<script>
(function () {
  const crumb = document.getElementById('breadcrumb-current');
  const titleEl = document.getElementById('tag-title');
  const descEl = document.getElementById('tag-desc');
  const countEl = document.getElementById('tag-count');
  const relatedWrap = document.getElementById('related-tags');
  const featContainer = document.getElementById('featured-container');
  const grid = document.getElementById('tag-grid');

  if (!grid || !featContainer) return;

  grid.innerHTML = '';
  relatedWrap.innerHTML = '';

  const parts = window.location.pathname.split('/');
  const idx = parts.indexOf('tag');
  const slug = idx !== -1 ? decodeURIComponent(parts[idx + 1] || '') : '';

  const pretty = slug.replace(/-/g, ' ').replace(/\b\w/g, c => c.toUpperCase());
  titleEl.textContent = pretty;
  crumb.textContent = pretty;

  Promise.all([
    fetch(`/api/blog/posts/tag/${encodeURIComponent(slug)}?limit=30`).then(r => r.json()).catch(() => []),
    fetch(`/api/blog/tags/related/${encodeURIComponent(slug)}`).then(r => r.json()).catch(() => [])
  ]).then(([posts, related]) => {
    const list = Array.isArray(posts) ? posts : (posts.posts || []);
    if (countEl) countEl.textContent = `${list.length} articles featuring this tag`;

    if (list.length) {
      renderFeatured(list[0]);
      list.slice(1).forEach(p => grid.insertAdjacentHTML('beforeend', createCardHTML(p)));
    } else {
      featContainer.textContent = 'No articles yet.';
    }

    if (relatedWrap) {
      related.forEach(t => {
        relatedWrap.insertAdjacentHTML('beforeend', `<span class="tag-cloud-item bg-white text-luxury-dark px-6 py-3 rounded-full font-medium elegant-border hover:bg-luxury-gold hover:text-white hover:border-luxury-gold transition-all cursor-pointer">#${t}</span>`);
      });
    }
  }).catch(err => {
    console.error(err);
    featContainer.textContent = 'Failed to load content.';
  });

  function createFeaturedHTML(a) {
    const img = a.featured_image || '';
    const cat = a.category || 'Luxury';
    const date = new Date(a.published_at || Date.now()).toLocaleDateString(undefined,{year:'numeric',month:'long',day:'numeric'});
    return `
    <article class="luxury-hover cursor-pointer">
      <div class="bg-white rounded-lg elegant-border overflow-hidden">
        <div class="relative h-64 lg:h-96">${img ? `<img src="${img}" alt="${a.title}" class="w-full h-full object-cover">` : ''}<div class="absolute inset-0 featured-overlay"><div class="absolute bottom-8 left-8 right-8 text-white"><div class="flex items-center space-x-2 mb-4"><span class="bg-luxury-gold text-white px-3 py-1 rounded-full text-sm font-medium">FEATURED</span><span class="bg-white bg-opacity-20 text-white px-3 py-1 rounded-full text-sm">${cat}</span></div><h3 class="font-serif text-2xl lg:text-4xl font-light mb-4">${a.title}</h3><p class="text-sm md:text-base">${a.excerpt || ''}</p><div class="flex items-center space-x-4 text-xs mt-4"><span>By ${a.author || 'Editor'}</span><span>${date}</span></div></div></div></div>
      </div>
    </article>`;
  }

  function renderFeatured(a) { featContainer.innerHTML = createFeaturedHTML(a); }

  function createCardHTML(a) {
    const img = a.featured_image || '';
    const cat = a.category || 'Luxury';
    const read = a.read_time || 5;
    return `
    <article class="luxury-hover cursor-pointer group">
      <div class="bg-white rounded-lg elegant-border overflow-hidden h-full">
        <div class="relative h-48">${img ? `<img src="${img}" alt="${a.title}" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500">` : ''}<div class="absolute top-4 left-4"><span class="bg-luxury-gold text-white px-3 py-1 rounded-full text-xs font-medium">${cat}</span></div></div>
        <div class="p-6"><h3 class="font-serif text-lg font-medium text-luxury-dark mb-3 group-hover:text-luxury-gold transition-colors line-clamp-2">${a.title}</h3><p class="text-gray-600 text-sm mb-4 line-clamp-3">${a.excerpt || ''}</p><div class="flex items-center justify-between text-xs text-gray-500"><span>${a.author || 'Editor'}</span><span>${read} min read</span></div></div>
      </div>
    </article>`;
  }
})();
</script>